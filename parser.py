import os
import requests
import time
from datetime import datetime
import urllib.parse
import re

# ĞšĞĞĞ¤Ğ˜Ğ“Ğ£Ğ ĞĞ¦Ğ˜Ğ¯ (Ğ½Ğµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ñ‚ Ğ¾Ñ‚ Ğ´Ğ°Ñ‚)
TOKEN = os.getenv('TG_TOKEN', '7521422533:AAE2UaEpXpH8yh22gM2nAy3iQKg2EqAkYts')
CHAT = os.getenv('TG_CHAT', '819701342')

BOOKS = [
    "ĞŸÑƒÑ‚ÑŒ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ°Ğ³ĞµĞ½Ñ‚ÑÑ‚Ğ²Ğ° Ğ¢Ğ¾Ñ€Ğ±Ğ¾ÑĞ¾Ğ²",
    "Ğ”Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¼ĞµĞ´Ğ¸Ñ†Ğ¸Ğ½Ğ° Ñ‚Ğ°Ğ»Ğ°Ğ½Ñ‚Ğ¾Ğ²",
    "0,05 Ğ´Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¼ĞµĞ´Ğ¸Ñ†Ğ¸Ğ½Ğ° ĞŸĞµÑ‚Ñ€ Ğ¢Ğ°Ğ»Ğ°Ğ½Ñ‚Ğ¾Ğ²",
    "Ritz Carlton Ğ¨ÑƒĞ»ÑŒÑ†Ğµ Ğ¥Ğ¾Ñ€ÑÑ‚",
    "Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ“Ğ°Ñ€Ğ¾Ğ»ÑŒĞ´ ĞºĞµÑ€Ñ†Ğ½ĞµÑ€",
    "Ğ‘Ğ»Ğ°Ğ³Ğ¾Ğ²Ğ¾Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¸Ñ†Ñ‹ Ğ»Ğ¸Ñ‚Ñ‚ĞµĞ»Ğ»",
    "Ğ¡Ğ¸Ğ½Ğ´Ñ€Ğ¾Ğ¼ ĞŸĞ°Ğ³Ğ°Ğ½Ğ¸Ğ½Ğ¸",
    "ĞœĞ°ÑÑ‚ĞµÑ€ÑÑ‚Ğ²Ğ¾ ÑƒÑ‡Ğ¸Ñ‚ĞµĞ»Ñ Ğ»ĞµĞ¼Ğ¾Ğ²",
    "ĞœĞ°ÑÑˆÑ‚Ğ°Ğ± Ğ”Ğ¶ĞµÑ„Ñ„Ñ€Ğ¸ Ğ£ÑÑÑ‚",
    "Ğ§ĞµĞ»Ğ¾Ğ²ĞµĞº Ğ½Ğ° Ğ²ÑĞµ Ñ€Ñ‹Ğ½ĞºĞ¸ Ñ‚Ğ¾Ñ€Ğ¿",
    "Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸ Ğ³ĞµĞ½Ğ¸ĞµĞ² Ğ”Ğ¸Ğ»Ñ‚Ñ",
    "Ğ”Ğ½ĞµĞ²Ğ½Ğ¸Ğº Ñ€ĞµĞ°Ğ»Ğ¸ÑÑ‚Ğ° Ğ’Ğ¾Ğ»Ğ¾Ñ‡ĞºĞ¾Ğ²",
    "ĞŸĞµÑ€Ğ²Ñ‹Ğµ 20 Ñ‡Ğ°ÑĞ¾Ğ² ĞšĞ°ÑƒÑ„Ğ¼Ğ°Ğ½",
    "ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿ ĞĞ±Ñ€Ğ°Ğ¼Ğ¾Ğ²Ğ¸Ñ‡Ğ° Ğ”Ğ¾Ñ€Ğ¾Ñ„ĞµĞµĞ²",
    "Ğ£ĞºÑ€Ğ¾Ñ‰ĞµĞ½Ğ¸Ğµ Ğ°Ğ¼Ğ¸Ğ³Ğ´Ğ°Ğ»Ñ‹",
    "ĞŸÑÑ‚Ğ°Ñ Ğ´Ğ¸ÑÑ†Ğ¸Ğ¿Ğ»Ğ¸Ğ½Ğ° Ğ¡ĞµĞ½Ğ³Ğµ",
    "Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ñ‹Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ Ñ…Ğ¾Ñ€Ğ¾Ğ²Ğ¸Ñ†",
    "ĞšĞ°Ğº Ğ»ÑĞ´Ğ¸ ÑƒÑ‡Ğ°Ñ‚ÑÑ Ğ¨ĞµĞºĞ»Ñ‚Ğ¾Ğ½",
    "Ğ‘Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ° Ğ¡Ğ±ĞµÑ€Ğ±Ğ°Ğ½ĞºĞ°",
    "Ğ½Ğ°ĞºĞ°Ğ·Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ°Ğ³Ñ€Ğ°Ğ´Ğ¾Ğ¹ ĞĞ»ÑŒÑ„Ğ¸ ĞšĞ¾Ğ½",
    "Ğ¸Ğ½Ğ½Ğ¾Ğ²Ğ°Ñ‚Ğ¾Ñ€Ñ‹ ĞĞ¹Ğ·ĞµĞºÑĞ¾Ğ½ Ğ£Ğ¾Ğ»Ñ‚ĞµÑ€",
    "ĞŸĞ°Ñ€Ğ°Ğ´Ğ¾ĞºÑ Ğ¿ĞµÑ€Ñ„ĞµĞºÑ†Ğ¸Ğ¾Ğ½Ğ¸ÑÑ‚Ğ°",
    "ĞœĞ¾Ñ‚Ğ¸Ğ²Ğ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ Ñ‚Ğ²Ğ¾Ñ€Ñ‡ĞµÑĞºĞ¸Ñ… Ğ»ÑĞ´ĞµĞ¹ ĞœĞ°ĞºĞ³Ğ¸Ğ½Ğ½ĞµÑÑ",
    "ĞºĞ°Ğº Ñ€Ğ¾Ğ¶Ğ´Ğ°ÑÑ‚ÑÑ ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¸ Ğ»Ğ¸Ğ·Ğ° Ğ±Ğ°Ñ€Ñ€ĞµÑ‚Ñ‚",
    "Ğ²Ğ·Ğ»Ğ¾Ğ¼ ĞºÑ€ĞµĞ°Ñ‚Ğ¸Ğ²Ğ° ĞœĞ°Ğ¹ĞºĞ» ĞœĞ¸ĞºĞ°Ğ»ĞºĞ¾",
    "ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ñ€Ğ¸ÑĞ¾Ğ²Ñ‹Ğ¹ ÑˆÑ‚ÑƒÑ€Ğ¼ ĞœĞ°Ğ¹ĞºĞ» ĞœĞ¸ĞºĞ°Ğ»ĞºĞ¾",
    "Ğ’ Ğ¿Ğ¾Ğ¸ÑĞºĞ°Ñ… Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ ĞºĞ°Ğ½Ğ´ĞµĞ»ÑŒ",
    "Ğ Ğ°ÑÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ğ°Ñ Ğ¿ÑĞ¸Ñ…Ğ¸ĞºĞ° ĞºĞ°Ğ½Ğ´ĞµĞ»ÑŒ",
    "ĞºĞ¸ÑĞ»Ğ¾Ñ€Ğ¾Ğ´ ĞĞ¸Ğº Ğ›ÑĞ¹Ğ½",
    "ĞºĞ¾Ğ´ ĞŸĞµÑ‚Ñ†Ğ¾Ğ»ÑŒĞ´ Ğ§Ğ°Ñ€Ğ»ÑŒĞ·",
    "Ğ¿Ğ¾Ñ‡ĞµĞ¼Ñƒ Ñ Ğ¾Ñ‚Ğ²Ğ»ĞµĞºĞ°ÑÑÑŒ Ğ­Ğ´Ğ²Ğ°Ñ€Ğ´ Ğ¥ÑĞ»Ğ»Ğ¾Ğ²ÑĞ»Ğ»",
    "Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿ ÑÑ‚Ğ°Ğ²Ğ¾Ğº ÑĞ½Ğ½Ğ¸ Ğ´ÑŒÑĞº",
    "ÑĞ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ·Ğ°Ğ¿Ğ»Ğ°Ñ‚Ğ¸ ÑĞµĞ±Ğµ ĞœĞ¸ĞºĞ°Ğ»Ğ¾Ğ²Ğ¸Ñ†",
    "ÑĞ»ĞµĞ³Ğ¸Ñ Ñ…Ğ¸Ğ»Ğ»Ğ±Ğ¸Ğ»Ğ»Ğ¸ Ğ”Ğ¶ĞµĞ¹ Ğ”Ğ¸ Ğ’ÑĞ½Ñ",
    "ÑĞ¿Ğ¸Ğ½ Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ğ¸ Ğ½Ğ¸Ğ» Ñ€ĞµĞºÑ…ÑĞ¼",
    "ĞĞµĞ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ğµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½ ĞšĞ¸Ğ³Ğ°Ğ½",
    "Ğ­Ñ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ñ€ÑƒĞºĞ¾Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒ Ğ¿Ğ¸Ñ‚ĞµÑ€ Ğ´Ñ€ÑƒĞºĞµÑ€",
    "Ğ’Ñ€ĞµĞ¼Ñ Ğ‘ĞµÑ€ĞµĞ·Ğ¾Ğ²ÑĞºĞ¾Ğ³Ğ¾ Ğ°Ğ²ĞµĞ½",
    "Ğ‘Ğ¸Ğ¾Ñ…Ğ°ĞºĞ¸Ğ½Ğ³ ĞĞ»Ğ»Ğ¸ Ğ¡Ğ¾Ğ²Ğ¸ÑÑ€Ğ²Ğ¸",
    "ĞŸĞ°Ğ¼ÑÑ‚ÑŒ Ğ½Ğµ Ğ¸Ğ·Ğ¼ĞµĞ½ÑĞµÑ‚ Ğ½Ğ°Ğ²Ğ°Ñ€Ñ€Ğ¾",
    "Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¸Ñ†Ğ¸Ğ¸ ÑˆĞ°Ñ€Ğ¿",
    "Ğ Ğ¨Ñ€Ğ¸Ñ„Ñ‚Ğµ ÑÑ€Ğ¸Ğº Ğ¨Ğ¿Ğ¸ĞºĞµÑ€Ğ¼Ğ°Ğ½Ğ½",
    "Ğ¼Ğ°ÑÑ‚ĞµÑ€ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ğ¹ ĞŸĞ¾Ğ» Ğ¡Ğ¼Ğ¸Ñ‚",
    "Ñ€Ğ¾Ğ¼Ğ° ĞµĞ´ĞµÑ‚ Ñ€Ğ¾Ğ¼Ğ°Ğ½ Ğ¡Ğ²ĞµÑ‡Ğ½Ğ¸ĞºĞ¾Ğ²",
    "Ñ‚Ğ¸ÑˆĞ¸Ğ½Ğ° Ñ‚Ğ¸Ñ‚ Ğ½Ğ°Ñ‚ Ñ…Ğ°Ğ½",
    "Ğ±ĞµÑÑÑ‚Ñ€Ğ°ÑˆĞ¸Ğµ Ñ‚Ğ¸Ñ‚ Ğ½Ğ°Ñ‚ Ñ…Ğ°Ğ½",
    "lift Ğ˜Ğ³Ğ¾Ñ€ÑŒ ĞšĞ°Ğ»Ğ¸Ğ½Ğ°ÑƒÑĞºĞ°Ñ",
    "Ğ² Ğ¿Ğ¾ÑÑ‚ĞµĞ»Ğ¸ Ñ Ğ²Ñ€Ğ°Ğ³Ğ¾Ğ¼ Ğ¥ÑĞ» Ğ’Ğ¾Ğ½",
    "Ğ³Ğ»Ğ°Ğ²Ğ½Ğ°Ñ ĞºĞ½Ğ¸Ğ³Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ Ğ±Ğ¸Ğ·Ğ½ĞµÑĞ° Ğ’Ğ°ÑÑĞµÑ€Ğ¼Ğ°Ğ½",
    "Ğ³Ğ»Ğ°Ğ·Ğ°Ğ¼Ğ¸ Ñ„Ğ¸Ğ·Ğ¸ĞºĞ° Ğ»ĞµĞ²Ğ¸Ğ½ ÑƒĞ¾Ğ»Ñ‚ĞµÑ€",
    "Ğ³Ğ¾Ğ´ Ğ±ĞµĞ· Ğ¿Ğ¾ĞºÑƒĞ¿Ğ¾Ğº ĞºĞµĞ¹Ñ‚ Ñ„Ğ»Ğ°Ğ½Ğ´ĞµÑ€Ñ",
    "ĞµÑˆÑŒ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ Ğ±ĞµĞ³Ğ¸ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾ Ğ¡ĞºĞ¾Ñ‚Ñ‚ Ğ”Ğ¶ÑƒÑ€ĞµĞº",
    "ĞºĞ°Ğº ÑÑ‚Ğ¾ Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¾ ĞœĞ°ĞºĞ¾Ğ»Ğ¸",
    "Ğ¸ÑĞºÑƒÑÑÑ‚Ğ²Ğ¾ ÑÑ‚Ğ¾Ñ€Ğ¸Ñ‚ĞµĞ»Ğ»Ğ¸Ğ½Ğ³Ğ° ĞšĞ°Ñ€Ğ¼Ğ¸Ğ½ Ğ“Ğ°Ğ»Ğ»Ğ¾",
    "Ğ¼Ğ°ÑÑ‚ĞµÑ€ ÑĞ»Ğ¾Ğ²Ğ° ĞšĞ°Ñ€Ğ¼Ğ¸Ğ½ Ğ“Ğ°Ğ»Ğ»Ğ¾",
    "Ğ¨Ğ¿Ğ¸Ğ¾Ğ½ Ğ½Ğ° Ğ¼Ğ¸Ğ»Ğ»Ğ¸Ğ°Ñ€Ğ´ Ğ´Ğ¾Ğ»Ğ»Ğ°Ñ€Ğ¾Ğ²",
    "ĞºĞ¾Ğ´ Ğ´ÑƒÑ€Ğ¾Ğ²Ğ°",
    "Ğ»ÑĞ´Ğ¸ ÑÑ€ĞµĞ´Ğ¸ Ğ´ĞµÑ€ĞµĞ²ÑŒĞµĞ²",
    "Ğ¼ĞµĞ½ÑÑ Ğ¶Ğ¸Ñ€ Ğ½Ğ° ÑĞ¸Ğ»Ñƒ Ğ²Ğ¾Ğ»Ğ¸ ÑÑ€Ğ¾ÑĞ»Ğ°Ğ² Ğ±Ñ€Ğ¸Ğ½",
    "Ğ¼ÑÑĞ¾ Ñ ĞºÑ€Ğ¾Ğ²ÑŒÑ ÑĞ½Ñ‚Ğ¾Ğ½Ğ¸ Ğ±ÑƒÑ€Ğ´ĞµĞ½",
    "Ğ½Ğ° Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ²Ğ¾Ğ»Ğ½Ğµ Ğ­Ğ¼Ğ¸ Ğ‘ÑĞ½ĞºÑ",
    "Ğ¾Ğ³Ğ¸Ğ»Ğ²Ğ¸ Ğ¾ Ñ€ĞµĞºĞ»Ğ°Ğ¼Ğµ Ğ”ÑĞ²Ğ¸Ğ´ ĞĞ³Ğ¸Ğ»Ğ²Ğ¸",
    "Ğ¼Ğ¾Ñ Ğ¶Ğ¸Ğ·Ğ½ÑŒ Ğ² Ñ€ĞµĞºĞ»Ğ°Ğ¼Ğµ Ğ¥Ğ¾Ğ¿ĞºĞ¸Ğ½Ñ",
    "Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ğ½Ğ° Ğ¼Ğ¸Ğ»Ğ»Ğ¸Ğ¾Ğ½ Ğ´Ğ¾Ğ»Ğ»Ğ°Ñ€Ğ¾Ğ²",
    "Ğ¿Ğ°Ñ€Ğ°Ğ´Ğ¾ĞºÑ Ğ¿ĞµÑ€Ñ„ĞµĞºÑ†Ğ¸Ğ¾Ğ½Ğ¸ÑÑ‚Ğ° Ğ¢Ğ°Ğ» Ğ‘ĞµĞ½-Ğ¨Ğ°Ñ…Ğ°Ñ€",
    "ÑĞ»Ğ¾Ğ½ Ğ½Ğ° Ñ‚Ğ°Ğ½Ñ†Ğ¿Ğ¾Ğ»Ğµ",
    "ÑĞ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ¸ Ğ½Ğ° Ğ²ÑÑ Ğ¶Ğ¸Ğ·Ğ½ÑŒ Ğ›Ğ¾Ñ€ĞµĞ¹Ğ½ Ğ“Ñ€Ğ°Ğ±Ñ-Ğ£ÑÑÑ‚",
    "ÑƒĞ»ÑŒÑ‚Ñ€Ğ°Ğ¼Ñ‹ÑˆĞ»ĞµĞ½Ğ¸Ğµ Ñ…ÑĞ½Ğº Ğ´Ğ¶Ğ¾Ğ½",
    "Ğ¿ĞµÑ€Ğ²Ñ‹Ğµ 90 Ğ´Ğ½ĞµĞ¹ Ğ¼Ğ°Ğ¹ĞºĞ» ÑƒĞ¾Ñ‚ĞºĞ¸Ğ½Ñ",
    "18 Ğ¼Ğ¸Ğ½ÑƒÑ‚ Ğ±Ñ€ĞµĞ³Ğ¼Ğ°Ğ½",
    "Ğ¡Ğ¾ Ğ¼Ğ½Ğ¾Ğ¹ Ñ…Ğ¾Ñ‚ÑÑ‚ Ğ¾Ğ±Ñ‰Ğ°Ñ‚ÑŒÑÑ Ğ·Ğ²ĞµÑ€ĞµĞ²Ğ°",
    "Ğ Ğ°Ğ´Ğ¾ÑÑ‚ÑŒ Ğ¸Ğ·Ğ½ÑƒÑ‚Ñ€Ğ¸ Ñ‚Ğ°Ğ½"
]
def send_telegram(text):
    """Ğ£Ğ½Ğ¸Ğ²ĞµÑ€ÑĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ² Telegram"""
    url = f'https://api.telegram.org/bot{TOKEN}/sendMessage'
    try:
        r = requests.post(url, json={
            'chat_id': CHAT,
            'text': text,
            'parse_mode': 'HTML'
        }, timeout=5)
        return r.status_code == 200
    except:
        return False

def search_avito_today(book):
    """
    Ğ£Ğ½Ğ¸Ğ²ĞµÑ€ÑĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº ÑĞµĞ³Ğ¾Ğ´Ğ½ÑÑˆĞ½Ğ¸Ñ… Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğ¹.
    Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ñ Ğ»ÑĞ±Ñ‹Ğ¼Ğ¸ Ğ´Ğ°Ñ‚Ğ°Ğ¼Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ cd=1 ĞĞ²Ğ¸Ñ‚Ğ¾.
    """
    query = urllib.parse.quote(book)
    
    # ĞœĞĞ“Ğ˜Ğ¯: cd=1 = "Ğ·Ğ° ÑÑƒÑ‚ĞºĞ¸" - ĞĞ²Ğ¸Ñ‚Ğ¾ ÑĞ°Ğ¼ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€ÑƒĞµÑ‚ Ğ¿Ğ¾ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ¹ Ğ´Ğ°Ñ‚Ğµ
    url = f"https://www.avito.ru/rossiya/knigi_i_zhurnaly?cd=1&q={query}&s=104"
    
    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
        'Accept-Language': 'ru-RU,ru;q=0.9,en-US;q=0.8,en;q=0.7',
    }
    
    try:
        response = requests.get(url, headers=headers, timeout=10)
        
        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ° ĞºĞ°Ğ¿Ñ‡Ñƒ Ğ¸Ğ»Ğ¸ Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºÑƒ
        if 'Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½' in response.text or 'captcha' in response.text.lower():
            print(f"âš ï¸  ĞĞ²Ğ¸Ñ‚Ğ¾ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡Ğ¸Ğ» Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğ´Ğ»Ñ: {book}")
            return False, None, None
        
        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ° Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²
        if 'ĞĞµÑ‚ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ñ… Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğ¹' in response.text:
            return False, None, None
        
        # Ğ£ĞĞ˜Ğ’Ğ•Ğ Ğ¡ĞĞ›Ğ¬ĞĞ«Ğ™ ĞŸĞĞ Ğ¡Ğ˜ĞĞ“ (Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ñ Ğ»ÑĞ±Ğ¾Ğ¹ Ğ´Ğ°Ñ‚Ğ¾Ğ¹)
        # Ğ˜Ñ‰ĞµĞ¼ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚
        page = response.text
        
        # Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 1: Ğ½Ğ¾Ğ²Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° ĞĞ²Ğ¸Ñ‚Ğ¾
        link_match = re.search(r'itemprop="url"[^>]*content="(https://www\.avito\.ru[^"]+)"', page)
        date_match = re.search(r'data-marker="item-date">([^<]+)<', page)
        
        # Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 2: ÑÑ‚Ğ°Ñ€Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° (Ñ€ĞµĞ·ĞµÑ€Ğ²)
        if not link_match:
            link_match = re.search(r'href="(https://www\.avito\.ru/[^"]+/\d+)"', page)
        if not date_match:
            date_match = re.search(r'class="[^"]*date[^"]*"[^>]*>([^<]+)<', page)
        
        if link_match and date_match:
            item_url = link_match.group(1)
            pub_date = date_match.group(1).strip()
            
            # Ğ’ĞĞ–ĞĞ: ĞĞ²Ğ¸Ñ‚Ğ¾ ÑĞ°Ğ¼ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ "ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ"
            # "ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ" = Ğ²ÑĞµĞ³Ğ´Ğ° Ñ‚ĞµĞºÑƒÑ‰Ğ°Ñ Ğ´Ğ°Ñ‚Ğ° ĞºĞ°Ğ»ĞµĞ½Ğ´Ğ°Ñ€Ñ
            if 'ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ' in pub_date.lower():
                return True, item_url, pub_date
        
        return False, None, None
        
    except Exception as e:
        print(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ¾Ğ¸ÑĞºĞ° {book}: {e}")
        return False, None, None

def main():
    """Ğ’ĞµÑ‡Ğ½Ñ‹Ğ¹ Ğ¿Ğ°Ñ€ÑĞµÑ€ (Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ñ Ğ»ÑĞ±Ñ‹Ğ¼Ğ¸ Ğ´Ğ°Ñ‚Ğ°Ğ¼Ğ¸)"""
    current_datetime = datetime.now()
    date_str = current_datetime.strftime('%d.%m.%Y')
    time_str = current_datetime.strftime('%H:%M:%S')
    
    print(f"\n{'='*70}")
    print(f"ğŸŒ Ğ’Ğ•Ğ§ĞĞ«Ğ™ ĞŸĞĞ Ğ¡Ğ•Ğ  | Ğ”ĞĞ¢Ğ: {date_str} | Ğ’Ğ Ğ•ĞœĞ¯: {time_str}")
    print(f"{'='*70}")
    
    found_count = 0
    
    # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ²ÑĞµÑ… ĞºĞ½Ğ¸Ğ³
    for i, book in enumerate(BOOKS, 1):
        status = f"[{i:2d}/{len(BOOKS)}] {book[:40]:<40}"
        
        found, url, pub_date = search_avito_today(book)
        
        if found:
            found_count += 1
            print(f"{status} âœ… Ğ¡Ğ•Ğ“ĞĞ”ĞĞ¯ ({pub_date})")
            
            # Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ (Ğ´Ğ°Ñ‚Ğ° Ğ¿Ğ¾Ğ´ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸)
            message = (
                f"ğŸ†• <b>ĞĞĞ’ĞĞ• ĞĞ‘ĞªĞ¯Ğ’Ğ›Ğ•ĞĞ˜Ğ• {date_str}!</b>\n\n"
                f"ğŸ“– <b>{book}</b>\n"
                f"ğŸ“… {pub_date}\n"
                f"ğŸ”— <a href='{url}'>Ğ¡Ğ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ½Ğ° ĞĞ²Ğ¸Ñ‚Ğ¾</a>\n"
                f"â° ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ¾: {time_str}"
            )
            send_telegram(message)
            time.sleep(0.5)
        else:
            print(f"{status} ğŸ“­ Ğ½ĞµÑ‚ Ğ½Ğ¾Ğ²Ñ‹Ñ…")
        
        time.sleep(1)
    
    # Ğ˜Ñ‚Ğ¾Ğ³
    print(f"{'='*70}")
    print(f"ğŸ“Š Ğ˜Ğ¢ĞĞ“ {date_str}: {found_count} Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ¸Ğ· {len(BOOKS)} ĞºĞ½Ğ¸Ğ³")
    print(f"{'='*70}")
    
    if found_count > 0:
        send_telegram(
            f"ğŸ“Š <b>ĞÑ‚Ñ‡Ñ‘Ñ‚ {date_str}</b>\n"
            f"âœ… ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ¾: {found_count} Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğ¹\n"
            f"ğŸ”„ Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ‡ĞµÑ€ĞµĞ· 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚"
        )

if __name__ == "__main__":
    main()
